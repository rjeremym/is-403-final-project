<!-- FILE: views/viewIdeas.ejs -->
<%- include('partials/header') %>

<div class="page-header">
    <h1>Your Business Ideas</h1>
    <a href="/add-idea" class="btn btn-primary">+ Add New Idea</a>
</div>

<div class="filters-section">
    <form method="GET" action="/view-ideas" class="filters-form">
        <div class="filter-group">
            <label for="ideaname">Idea Name</label>
            <input 
                type="text" 
                id="ideaname" 
                name="ideaname"
                value="<%= filters.ideaname || '' %>"
                placeholder="Search by name..."
            >
        </div>
        
        <div class="filter-group">
            <label for="marketingstrategy">Marketing Strategy</label>
            <select id="marketingstrategy" name="marketingstrategy">
                <option value="">All Strategies</option>
                <option value="Social Media Marketing" <%= filters.marketingstrategy === 'Social Media Marketing' ? 'selected' : '' %>>Social Media Marketing</option>
                <option value="Content Marketing" <%= filters.marketingstrategy === 'Content Marketing' ? 'selected' : '' %>>Content Marketing</option>
                <option value="Email Marketing" <%= filters.marketingstrategy === 'Email Marketing' ? 'selected' : '' %>>Email Marketing</option>
                <option value="SEO" <%= filters.marketingstrategy === 'SEO' ? 'selected' : '' %>>SEO</option>
                <option value="Paid Advertising" <%= filters.marketingstrategy === 'Paid Advertising' ? 'selected' : '' %>>Paid Advertising</option>
                <option value="Influencer Marketing" <%= filters.marketingstrategy === 'Influencer Marketing' ? 'selected' : '' %>>Influencer Marketing</option>
                <option value="Word of Mouth" <%= filters.marketingstrategy === 'Word of Mouth' ? 'selected' : '' %>>Word of Mouth</option>
                <option value="Partnership Marketing" <%= filters.marketingstrategy === 'Partnership Marketing' ? 'selected' : '' %>>Partnership Marketing</option>
            </select>
        </div>
        
        <div class="filter-group">
            <label for="potential">Min Success Potential</label>
            <select id="potential" name="potential">
                <option value="">Any Potential</option>
                <option value="1" <%= filters.potential === '1' ? 'selected' : '' %>>1+</option>
                <option value="2" <%= filters.potential === '2' ? 'selected' : '' %>>2+</option>
                <option value="3" <%= filters.potential === '3' ? 'selected' : '' %>>3+</option>
                <option value="4" <%= filters.potential === '4' ? 'selected' : '' %>>4+</option>
                <option value="5" <%= filters.potential === '5' ? 'selected' : '' %>>5+</option>
                <option value="6" <%= filters.potential === '6' ? 'selected' : '' %>>6+</option>
                <option value="7" <%= filters.potential === '7' ? 'selected' : '' %>>7+</option>
                <option value="8" <%= filters.potential === '8' ? 'selected' : '' %>>8+</option>
                <option value="9" <%= filters.potential === '9' ? 'selected' : '' %>>9+</option>
                <option value="10" <%= filters.potential === '10' ? 'selected' : '' %>>10</option>
            </select>
        </div>
        
        <div class="filter-group">
            <label for="maxcost">Max Cost ($)</label>
            <input 
                type="number" 
                id="maxcost" 
                name="maxcost"
                min="0"
                step="0.01"
                value="<%= filters.maxcost || '' %>"
                placeholder="e.g., 1000"
            >
        </div>
        
        <button type="submit" class="btn btn-primary">Filter</button>
        <a href="/view-ideas" class="btn btn-secondary">Clear</a>
    </form>
</div>

<% if (ideas.length === 0) { %>
    <div class="empty-state">
        <div class="empty-icon">üí°</div>
        <h3>No ideas found</h3>
        <p>Try adjusting your filters or add your first idea!</p>
        <a href="/add-idea" class="btn btn-primary">Add Your First Idea</a>
    </div>
<% } else { %>
    <div class="ideas-grid">
        <% ideas.forEach(idea => { %>
            <div class="idea-card">
                <div class="idea-card-header">
                    <h3><%= idea.ideaname %></h3>
                    <% if (idea.potential) { %>
                        <span class="potential-badge">‚≠ê <%= idea.potential %>/10</span>
                    <% } %>
                </div>
                
                <p class="idea-description"><%= idea.ideadescription %></p>
                
                <div class="idea-details">
                    <% if (idea.marketingstrategy && idea.marketingstrategy.length > 0) { %>
                        <div class="detail-row">
                            <span class="detail-label">Marketing:</span>
                            <div class="strategy-tags">
                                <% idea.marketingstrategy.forEach(strategy => { %>
                                    <span class="strategy-tag"><%= strategy %></span>
                                <% }); %>
                            </div>
                        </div>
                    <% } %>
                    
                    <% if (idea.targetcustomer) { %>
                        <div class="detail-row">
                            <span class="detail-label">Target:</span>
                            <span><%= idea.targetcustomer %></span>
                        </div>
                    <% } %>
                    
                    <% if (idea.estimatedcost) { %>
                        <div class="detail-row">
                            <span class="detail-label">Cost:</span>
                            <span class="cost-value">$<%= parseFloat(idea.estimatedcost).toLocaleString() %></span>
                        </div>
                    <% } %>
                    
                    <% if (idea.timeline) { %>
                        <div class="detail-row">
                            <span class="detail-label">Timeline:</span>
                            <span><%= idea.timeline %></span>
                        </div>
                    <% } %>
                </div>
                
                <div class="idea-meta">
                    <span class="idea-owner">
                        <strong>Owner:</strong> <%= idea.creator_firstname %>
                    </span>
                    <span class="idea-date"><%= new Date(idea.createdat).toLocaleDateString() %></span>
                </div>
                
                <div class="idea-actions">
                    <a href="/edit-idea/<%= idea.ideaid %>" class="btn btn-small btn-secondary">Edit</a>
                    <% if (idea.is_owner) { %>
                        <form method="POST" action="/delete-idea/<%= idea.ideaid %>" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this idea?');">
                            <button type="submit" class="btn btn-small btn-danger">Delete</button>
                        </form>
                    <% } %>
                </div>
            </div>
        <% }); %>
    </div>
<% } %>

<%- include('partials/footer') %>
